@model List<Equipment>
@{
    var errorMessage = TempData["Error"] as string;
    var ownedEquipment = ViewBag.OwnedEquipment as List<NinjaHasEquipment>;
    var ownedEquipmentIds = ownedEquipment.Select(nhe => nhe.EquipmentId).ToHashSet();
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Item Shop</title>
    <link rel="stylesheet" href="/css/Shop.css" />
</head>
<body>

    <h1>Item Shop</h1>

    @if (!string.IsNullOrEmpty(errorMessage))

    {
        <div class="alert alert-danger">
            @errorMessage
        </div>
    }

    <div class="item-grid">
        @foreach (var equipment in Model)

            {
            if (ownedEquipmentIds.Contains(equipment.Id))
            {
                var ownedItem = ownedEquipment.First(nhe => nhe.EquipmentId == equipment.Id);
                <div class="item-card">
                    <h3>@equipment.EquipmentType : @equipment.Name</h3>
                    <p>Strength : @equipment.Strength</p>
                    <p>Agility : @equipment.Agility</p>
                    <p>Intelligence : @equipment.Intelligence</p>
                    <p>ValuePaid : @ownedItem.ValuePaid Gold</p>

                    <form asp-action="Sell" method="post">
                        <input type="hidden" name="NinjaId" value="@ViewBag.NinjaId" />
                        <input type="hidden" name="EquipmentId" value="@equipment.Id" />
                        <button type="submit">Sell</button>
                    </form>
                </div>
            }
            else
            { 
            <div class="item-card">
                <h3>@equipment.EquipmentType : @equipment.Name</h3>
                <p>Strength : @equipment.Strength</p>
                <p>Agility : @equipment.Agility</p>
                <p>Intelligence : @equipment.Intelligence</p>
                <p>Value : @equipment.Value Gold</p>

                <form asp-action="Buy" method="post">
                    <input type="hidden" name="NinjaId" value="@ViewBag.NinjaId" />
                    <input type="hidden" name="EquipmentId" value="@equipment.Id" />
                    <button type="submit">Buy</button>
                </form>
            </div>
            }
        }
    </div>

</body>
</html>